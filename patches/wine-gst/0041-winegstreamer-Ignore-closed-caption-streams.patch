From 210119207e74e498e39ffd80e58b5735bb058e42 Mon Sep 17 00:00:00 2001
From: Torge Matthies <openglfreak@googlemail.com>
Date: Sun, 24 Nov 2024 03:59:55 +0100
Subject: [PATCH 41/52] winegstreamer: Ignore closed caption streams.

---
 dlls/winegstreamer/wg_parser.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/dlls/winegstreamer/wg_parser.c b/dlls/winegstreamer/wg_parser.c
index 478a9b73b56..3eba204d027 100644
--- a/dlls/winegstreamer/wg_parser.c
+++ b/dlls/winegstreamer/wg_parser.c
@@ -1563,6 +1563,7 @@ static void pad_added_cb(GstElement *element, GstPad *pad, gpointer user)
 {
     struct wg_parser_stream *stream;
     struct wg_parser *parser = user;
+    const GstStructure *structure;
     GstCaps *caps;
 
     GST_LOG("parser %p, element %p, pad %p.", parser, element, pad);
@@ -1580,6 +1581,10 @@ static void pad_added_cb(GstElement *element, GstPad *pad, gpointer user)
     if (gst_caps_is_any(caps = gst_pad_query_caps(pad, NULL)))
         caps = gst_pad_get_current_caps(pad);
 
+    structure = gst_caps_get_structure(caps, 0);
+    if (!strncmp(gst_structure_get_name(structure), "text/", 5))
+        return;
+
     if (!(stream = create_stream(parser, gst_pad_get_stream_id(pad))))
         return;
     stream->codec_caps = caps;
-- 
2.47.2

